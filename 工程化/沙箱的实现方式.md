---
title: 沙箱的实现方式
date: 2022-05-16 23:19:07
sidebar: auto
tags:
  - 沙箱
categories:
  - 前端工程化
---

1. `iframe` 实现
   - 全局变量隔离，如 `setTimeout、location、react` 不同版本隔离
   - 路由隔离，应用可以实现独立路由，也可以共享全局路由
   - 多实例，可以同时存在多个独立的微应用同时运行
2. 快照
   - 在不支持代理的浏览器中，我们可以通过 `diff` 的方式实习沙箱。在应用运行的时候保存一个快照 `window` 对象，将当前 `window` 对象的全部属性都复制到快照对象上，子应用卸载的时候将 `window` 对象修改做个 `diff`，将不同的属性用个 modifyMap 保存起来，再次挂载的时候再加上这些修改的属性。
3. 基于代理 `Proxy` 实现单实例沙箱
   - 在 `ES6` 当中，我们可以通过代理(`Proxy`)实现对象的劫持。基本实录也是通过 `window` 对象的修改进行记录，在卸载时删除这些记录，在应用再次激活时恢复这些记录，来达到模拟沙箱环境的目的。

---

[微前端 qiankun 沙箱源码解读](https://juejin.cn/post/6981756262304186405)
