---
title: 闭包
date: 2020-05-06 16:19:57
---

## 闭包是怎么生成的

**闭包可以让你从内部函数访问外部函数作用域。**

1. **函数怎么访问变量：作用域和作用域链**

- 那什么是作用域呢？其实就是 JS 在编译代码阶段，会生成一个`执行上下文`和`可执行代码`
- 执行上下文就包含了变量环境和词法环境。函数是怎么引用变量的，首先它会从本函数内的作用域进行查找
- 先往词法环境 -> 变量环境找，找不到的话就会从上一个执行上下文生成的作用域进行查找，一般就指的是外部的函数。
- 那么这个找变量的过程就是**作用域链**。

2. **为什么会产生闭包**

- 一般情况下，在执行完一个函数后，它的执行上下文就会出栈，释放内存。但是由于它的变量被内嵌的函数所引用，就会形成一个闭包环境，继续让这个函数引用，而这个时候呢内存中就有闭包了。直到引用的函数执行完毕被销毁。

## 闭包的应用

应用闭包的主要场合是：设计私有的方法和变量。

比如防抖、函数柯理化、函数记忆...

## 闭包的缺陷（内存泄露）

- 闭包的缺点就是常驻内存会增大内存使用量，并且使用不当很容易造成内存泄露。
- 如果不是因为某些特殊任务而需要闭包，在没有必要的情况下，在其它函数中创建函数是不明智的，因为闭包对脚本性能具有负面影响，包括处理速度和内存消耗。

## 垃圾回收机制
