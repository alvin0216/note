---
title: 作用域
date: 2020-10-10 09:39:12
---

:::details 预备知识：javascript 编译代码的过程

`javascript` 执行一段代码前，会对程序进行 `编译`：

1. **词法分析**
2. **语法分析**：生成 AST
3. **代码生成**：转换 AST 为可执行的机器指令。

编译 var a = 2;

- 词法分析: `var`, `a`, `=`, `2`, `;`
- <span class='mgreen'>语法分析: 生成 AST</span>
  - 抽象语法树中可能会有一个叫作 `VariableDeclaration` 的顶级节点，接下 来是一个叫作 `Identifier`（它的值是 a）的子节点
  - 以及一个叫作 `AssignmentExpression` 的子节点。`AssignmentExpression` 节点有一个叫作 `NumericLiteral（它的值是` 2）的子 节点。
- <span class='mgreen'>代码生成</span>: 将 AST 转化为一组机器指 令，用来创建一个叫作 a 的变量（包括分配内存等），并将一个值储存在 a 中。

:::

## 查找变量

- **引擎**: 从头到尾负责整个 JavaScript 程序的编译及执行过程。
- **编译器**: 如上，进行代码编译操作，语法分析、转换 AST、再转化为机器指令。
- **作用域**：<span class='mgreen'>作用域是一套规则，用于确定在何处以及如何查找变量（标识符）。</span>

编译器在编译过程的第二步中生成了代码，引擎执行它时，会通过查找变量 a 来判断它是 否已声明过。查找的过程由作用域进行协助。

如果查找的目的是对 变量进行赋值，那么就会使用 `LHS` 查询；如果目的是获取变量的值，就会使用 `RHS` 查询。

```js
```
