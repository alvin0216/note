---
title: 微前端
date: 2021-07-20 00:27:24
sidebar: auto
tags:
  - 微前端
  - 前端工程化
categories:
  - 前端工程化
---

## 相关资料

- [带你手写微前端框架](https://juejin.cn/post/6844903981223772168)
- [微前端在美团外卖的实践](https://juejin.cn/post/6844904073972432903)
- [2020 年你必须要会的微前端 -（实战篇）](https://juejin.cn/post/6854573221111398408)

> Single-Spa 核心

single-spa 的原理就是，将子项目中的 `link/script` 标签和`<div id="app"></div>`插入到主项目，而这个操作的核心就是动态加载 `js` 和 `css`。

> IFrame 优缺点

- **页面加载问题**: 影响主页面加载，阻塞 onload 事件，本身加载也很慢，页面缓存过多会导致电脑卡顿
- **布局问题**：iframe 必须给一个指定的高度，否则会塌陷。解决办法：子系统实时计算高度并通过 postMessage 发送给主页面，主页面动态设置高度，修改子系统或者代理插入脚本。有些情况会出现多个滚动条，用户体验不佳。
- **弹窗及遮罩层问题**：只能在 iframe 范围内垂直水平居中，没法在整个页面垂直水平居中。
- **浏览器前进/后退问题**：iframe 和主页面共用一个浏览历史，iframe 会影响页面的前进后退，大部分时候正常，iframe 多次重定向则会导致浏览器的前进后退功能无法正常使用，不是全部页面都会出现，基本可以忽略。但是 iframe 页面刷新会重置（比如说从列表页跳转到详情页，然后刷新，会返回到列表页），因为浏览器的地址栏没有变化。
- **iframe 的页面跳转到其他页面**出问题，比如两个 iframe 之间相互跳转，直接跳转会只在 iframe 范围内跳转，所以必须通过主页面来进行跳转。不过 iframe 跳转的情况很少
- 不同源的系统之间的通讯需要通过 postMessage，存在一定的**安全性**

优点

- 完全隔离了 css 和 js，避免了各个系统之间的样式和 js 污染
- 可以在子系统完全不修改的情况下嵌入进来
